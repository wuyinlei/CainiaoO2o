<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "com.ruolan.o2o.dao.ProductDao">


    <resultMap id="productMap" type="com.ruolan.o2o.entity.Product">
        <id column="product_id" property="productId" />
        <result column="product_name" property="productName" />
        <result column="product_desc" property="productDesc" />
        <result column="img_addr" property="imgAddr" />
        <result column="normal_price" property="normalPrice" />
        <result column="promotion_price" property="promotionPrice" />
        <result column="priority" property="priority" />
        <result column="create_time" property="createTime" />
        <result column="last_edit_time" property="lastEditTime" />
        <result column="enable_status" property="enableStatus" />
        <result column="point" property="point" />
        <association property="productCategory" column="product_category_id"
                     javaType="com.ruolan.o2o.entity.ProductCategory">
            <id column="product_category_id" property="productCategoryId" />
            <result column="product_category_name" property="productCategoryName" />
            <result column="product_category_desc" property="productCategoryDesc" />
            <result column="priority" property="priority" />
            <result column="create_time" property="createTime" />
            <result column="last_edit_time" property="lastEditTime" />
        </association>
        <association property="shop" column="shop_id"
                     javaType="com.ruolan.o2o.entity.Shop">
            <id column="shop_id" property="shopId" />
            <result column="owner_id" property="ownerId" />
            <result column="shop_name" property="shopName" />
            <result column="shop_desc" property="shopDesc" />
            <result column="shop_addr" property="shopAddr" />
            <result column="phone" property="phone" />
            <result column="shop_img" property="shopImg" />
            <result column="longitude" property="longitude" />
            <result column="latitude" property="latitude" />
            <result column="priority" property="priority" />
            <result column="create_time" property="createTime" />
            <result column="last_edit_time" property="lastEditTime" />
            <result column="enable_status" property="enableStatus" />
            <result column="advice" property="advice" />
        </association>
        <collection property="productImgList"
                    javaType="java.util.List"
                    ofType="com.ruolan.o2o.entity.ProductImg">
            <id column="product_img_id" property="productImgId" />
            <result column="img_addr_pm" property="imgAddr" />
            <result column="img_desc_pm" property="imgDesc" />
            <result column="priority" property="priority" />
            <result column="create_time" property="createTime" />
            <result column="product_id" property="productId" />
        </collection>
    </resultMap>


    <select id="queryProductByProductId" resultMap="productMap"
            parameterType="Long">
        <!-- 具体的sql -->
        SELECT
        p.*,
        pm.product_img_id,
        pm.img_addr as img_addr_pm,
        pm.img_desc as img_desc_pm,
        pm.priority ,
        pm.create_time
        FROM
        tb_product p
        ,
        tb_product_img pm

        WHERE
        p.product_id = #{productId} AND p.product_id = pm.product_id
        ORDER BY
        pm.priority DESC
    </select>


    <!--<select id="queryListForEach" resultMap="com.ruolan.o2o.entity.Product">-->

        <!--SELECT * FROM tb_product-->
        <!--<where>-->
            <!--<if test="ids != null">-->
                <!--&lt;!&ndash;-->
                    <!--foreach:循环传入的集合参数-->
                    <!--collection:传入的集合的变量名称-->
                    <!--item:每次循环将循环出的数据放入到这个变量中-->
                    <!--open:循环开始凭借的字符串-->
                    <!--close:循环结束拼接的字符串-->
                    <!--separator:循环中拼接的分隔符-->
                <!--&ndash;&gt;-->
                <!--<foreach collection="ids" item="id" open="id in (" close=")" separator=",">-->
                    <!--#{id}-->
                <!--</foreach>-->

            <!--</if>-->


        <!--</where>-->

    <!--</select>-->


    <!--一对一手动映射-->
    <!--
        id:resultMap的唯一标识
        type:将查询出的数据放入这个指定的对象中
        注意：手动映射需要将指定数据库表的字段名与java中pojo类的属性名称的对应关系
    -->

    <!--<resultMap id="productMapOne" type="com.ruolan.o2o.entity.Product">-->
        <!--&lt;!&ndash;id：标签指定主键字段对应关系-->
            <!--column:列,数据库中的字段名称-->
            <!--property：属性,java中pojo的属性名称-->
            <!--result:标签指定非主键字段的对应关系-->
        <!--&ndash;&gt;-->
        <!--<id column="product_id" property="productId" />-->
        <!--<result column="product_name" property="productName" />-->
        <!--<result column="product_desc" property="productDesc" />-->
        <!--<result column="img_addr" property="imgAddr" />-->
        <!--<result column="normal_price" property="normalPrice" />-->
        <!--<result column="promotion_price" property="promotionPrice" />-->
        <!--<result column="priority" property="priority" />-->
        <!--<result column="create_time" property="createTime" />-->
        <!--<result column="last_edit_time" property="lastEditTime" />-->
        <!--<result column="enable_status" property="enableStatus" />-->
        <!--<result column="point" property="point" />-->
        <!--<association property="productCategory" column="product_category_id"-->
                     <!--javaType="com.ruolan.o2o.entity.ProductCategory">-->
            <!--<id column="product_category_id" property="productCategoryId" />-->
            <!--<result column="product_category_name" property="productCategoryName" />-->
            <!--<result column="product_category_desc" property="productCategoryDesc" />-->
            <!--<result column="priority" property="priority" />-->
            <!--<result column="create_time" property="createTime" />-->
            <!--<result column="last_edit_time" property="lastEditTime" />-->
        <!--</association>-->
        <!--<association property="shop" column="shop_id"-->
                     <!--javaType="com.ruolan.o2o.entity.Shop">-->
            <!--<id column="shop_id" property="shopId" />-->
            <!--<result column="owner_id" property="ownerId" />-->
            <!--<result column="shop_name" property="shopName" />-->
            <!--<result column="shop_desc" property="shopDesc" />-->
            <!--<result column="shop_addr" property="shopAddr" />-->
            <!--<result column="phone" property="phone" />-->
            <!--<result column="shop_img" property="shopImg" />-->
            <!--<result column="longitude" property="longitude" />-->
            <!--<result column="latitude" property="latitude" />-->
            <!--<result column="priority" property="priority" />-->
            <!--<result column="create_time" property="createTime" />-->
            <!--<result column="last_edit_time" property="lastEditTime" />-->
            <!--<result column="enable_status" property="enableStatus" />-->
            <!--<result column="advice" property="advice" />-->
        <!--</association>-->
        <!--<collection property="productImgList"-->
                    <!--javaType="java.util.List"-->
                    <!--ofType="com.ruolan.o2o.entity.ProductImg">-->
            <!--<id column="product_img_id" property="productImgId" />-->
            <!--<result column="img_addr" property="imgAddr" />-->
            <!--<result column="img_desc" property="imgDesc" />-->
            <!--<result column="priority" property="priority" />-->
            <!--<result column="create_time" property="createTime" />-->
            <!--<result column="product_id" property="productId" />-->
        <!--</collection>-->
    <!--</resultMap>-->



</mapper>